---
title: "Лабораторная работа №10. Работа с файлами средствами Nasm"
author: "[Сунь Шэнцзе]"
date: 29 November 2025
format:
  pdf:
    documentclass: article
    mainfont: "DejaVu Serif"
    sansfont: "DejaVu Sans"
    monofont: "DejaVu Sans Mono"
    latex-engine: xelatex
    lang: ru
---

number: "1132254527"

## 1. Цель работы
- Приобретение навыков написания программ для работы с файлами
- Освоение системных вызовов для создания, чтения, записи и удаления файлов
- Изучение управления правами доступа к файлам в Linux
- Освоение работы с файловыми дескрипторами
- Изучение использования системных вызовов через прерывание 80h

## 2. Порядок выполнения работы и результаты

### 2.1 Шаг 1: Создание рабочего каталога и файлов
![Создание каталога](screenshots/1.png)
*   **Основное:** Успешное создание каталога для лабораторной работы `~/work/arch-pc/lab10` и создание файлов `lab10-1.asm`, `readme-1.txt`, `readme-2.txt` с помощью команды `touch`.

### 2.2 Шаг 2: Написание программы работы с файлами
![Исходный код](screenshots/3.png)
![Исходный код](screenshots/4.png)
*   **Основное:** Написание программы `lab10-1.asm` для работы с файлами, включающей функции создания файла, записи введенной строки и закрытия файла с использованием системных вызовов.

### 2.3 Шаг 3: Компиляция и запуск программы
![Результат запуска](screenshots/2.png)
*   **Основное:** Успешная компиляция программы с подключением библиотеки `in_out.asm`, запуск программы и ввод тестовой строки "Hello from Lab 10!" для записи в файл.

### 2.4 Шаг 4: Проверка создания файла
![Проверка файла](screenshots/5.png)
*   **Основное:** Проверка успешного создания файла `readme.txt` и его содержимого с помощью команд `ls -l` и `cat`, подтверждение корректной работы программы.

### 2.5 Шаг 5: Запрет выполнения программы
![Запрет выполнения](screenshots/6.png)
*   **Основное:** Демонстрация работы команды `chmod -x` для запрета выполнения программы, попытка запуска приводит к ошибке "Permission denied".

### 2.6 Шаг 6: Добавление прав выполнения исходному коду
![Попытка выполнения исходного кода](screenshots/7.png)
*   **Основное:** Добавление прав выполнения файлу с исходным кодом `lab10-1.asm` и демонстрация того, что текстовый файл не может быть выполнен как программа, несмотря на наличие прав.

### 2.7 Шаг 7: Установка прав доступа по варианту 8
![Установка прав](screenshots/8.png)
*   **Основное:** Установка прав доступа для файлов согласно варианту 8: `readme-1.txt` - `rw- -wx --x` (631), `readme-2.txt` - `--w---x---` (210).

### 2.8 Шаг 8: Проверка установленных прав
![Проверка прав](screenshots/8.png)
*   **Основное:** Проверка корректности установленных прав доступа с помощью команды `ls -l`, подтверждение соответствия заданным в варианте 8 значениям.

## 3. Выполнение заданий для самостоятельной работы

### 3.1 Написание программы для ввода и сохранения имени
![Код программы](screenshots/11.png)
![Код программы](screenshots/9.png)
![Код программы](screenshots/10.png)
*   **Вывод:** Успешное создание программы `name.asm`, которая запрашивает имя пользователя, создает файл `name.txt` и записывает в него приветственное сообщение с введенным именем.

### 3.2 Компиляция и тестирование программы
![Запуск программы](screenshots/12.png)
*   **Вывод:** Успешная компиляция и запуск программы, корректное создание файла `name.txt` с содержимым "Меня зовут [введенное имя]", подтверждение работоспособности всех функций программы.

### 3.3 Проверка результата
![Проверка файла](screenshots/13.png)
*   **Вывод:** Проверка созданного файла с помощью команд `ls -l` и `cat`, подтверждение корректного сохранения данных и правильной работы программы.

## 4. Ответы на вопросы для самопроверки

1. **Каким образом в Unix-подобных ОС определяются права доступа к файлу?**  
   Права доступа определяются с помощью 9 битов, разделенных на три группы по 3 бита: права владельца (user), группы (group) и остальных пользователей (others). Каждая группа определяет права на чтение (r), запись (w) и выполнение (x).

2. **Как ОС определяет, является ли файл исполняемым? Как регулировать права на чтение и запись?**  
   ОС проверяет установленный бит выполнения (x) в правах доступа. Права на чтение и запись регулируются с помощью команды `chmod` и установки соответствующих битов (r для чтения, w для записи).

3. **Как разграничить права доступа для различных категорий пользователей?**  
   С помощью команды `chmod` можно устанавливать права отдельно для владельца (u), группы (g) и остальных (o), например: `chmod u=rwx,g=rx,o=r filename`.

4. **Какой номер имеют системные вызовы sys_read, sys_write, sys_open, sys_close, sys_creat?**  
   - sys_read: 3
   - sys_write: 4  
   - sys_open: 5
   - sys_close: 6
   - sys_creat: 8

5. **Какие регистры и как используют системные вызовы sys_read, sys_write, sys_open, sys_close, sys_creat?**  
   Все системные вызовы используют:
   - EAX: номер системного вызова
   - EBX: первый аргумент (дескриптор файла или имя файла)
   - ECX: второй аргумент (адрес буфера или режим доступа)
   - EDX: третий аргумент (количество байтов или права доступа)

6. **Что такое дескриптор файла?**  
   Дескриптор файла — это уникальный числовой идентификатор, который операционная система присваивает открытому файлу. Это 16-битное целое число, используемое для последующих операций с файлом.

# Выводы

В ходе выполнения лабораторной работы №10 я успешно приобрел следующие навыки:

1. **Работа с файловыми системными вызовами**: Освоил использование системных вызовов Linux для создания, открытия, чтения, записи и закрытия файлов через прерывание 80h.

2. **Управление правами доступа**: Научился устанавливать и изменять права доступа к файлам с помощью команды `chmod`, понимаю разницу между символьной и числовой нотацией прав.

3. **Работа с файловыми дескрипторами**: Освоил концепцию файловых дескрипторов и их использование для идентификации открытых файлов в операционной системе.

4. **Обработка ошибок**: Научился анализировать возвращаемые значения системных вызовов для обработки возможных ошибок при работе с файлами.

5. **Создание интерактивных программ**: Разработал программу, которая взаимодействует с пользователем через командную строку и сохраняет введенные данные в файл.

6. **Компиляция и отладка**: Закрепил навыки компиляции ассемблерных программ с использованием NASM и компоновки с библиотечными функциями.

**Достижение целей работы**: Все цели лабораторной работы достигнуты. Я освоил программирование операций с файлами на языке ассемблера, научился управлять правами доступа и работать с файловыми дескрипторами. Выполнение задания для самостоятельной работы позволило закрепить полученные знания и развить практические навыки создания файловых утилит.
